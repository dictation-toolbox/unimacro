<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<title>technical details, natlinkstatus</title>
<meta charset="UTF-8">
<meta name="description" content="SourceForge project for Dragon NaturallySpeaking macro facility">
<meta name="keywords" content="Installation, Natlink/Vocola/Unimacro, technical, details, natlinkstatus, technical details, Installation Natlink/Vocola/Unimacro">
<meta name="author" content="QH software, training & advies, 2002/2017 (informatie: info at sitegen.nl)">
<link rel="stylesheet" href="../../unimacro.css" type="text/css" title="unimacro.css">
<!--[if lte IE 6]>
<link rel="stylesheet" href="../../unimacroie6.css" type="text/css" title="unimacroie6.css">
<![endif]-->
<!--[if IE 7]>
<link rel="stylesheet" href="../../unimacroie7.css" type="text/css" title="unimacroie7.css">
<![endif]-->
<!--[if IE 8]>
<link rel="stylesheet" href="../../unimacroie8.css" type="text/css" title="unimacroie8.css">
<![endif]-->
<!--[if IE 9]>
<link rel="stylesheet" href="../../unimacroie9.css" type="text/css" title="unimacroie9.css">
<![endif]-->
<script language="javascript" src="../../unimacro.js" type="text/javascript"></script><link href="/unimacro/favicon.ico" rel="shortcut icon" type="image/x-icon"></head>
<body onload="afterLoad();" onresize="onResize();"><div class="header" id="header"><!-- === start of header === -->

<table border="0" cellpadding="0" cellspacing="0" class="body" width="100%">
<tr><td class="banner">Unimacro</td><td width="30%">&nbsp;</td></tr></table>

<table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td height="15"></td></tr></table>
<div class="topmenuwide"><table border="0" cellspacing="0" class="menu" width="100%"><tr><td align="center" class="topon" height="28" onclick="location='../index.html';" onmouseout="status='';" onmouseover="status='Installation Natlink/Vocola/Unimacro';"><a href="../index.html">Installation Natlink/Vocola/Unimacro</a></td><td class="topspacer" height="28" width="5">&nbsp;</td><td align="center" class="topoff" height="28" onclick="location='../../features/index.html';" onmouseout="status='';" onmouseover="status='Features';"><a href="../../features/index.html">Features</a></td><td class="topspacer" height="28" width="5">&nbsp;</td><td align="center" class="topoff" height="28" onclick="location='../../grammars/index.html';" onmouseout="status='';" onmouseover="status='Grammars';"><a href="../../grammars/index.html">Grammars</a></td><td class="topspacer" height="28" width="5">&nbsp;</td>
<td align="center" class="topoff" height="28" onclick="location='../../aboutunimacro/index.html';" onmouseout="status='';" onmouseover="status='About';"><a href="../../aboutunimacro/index.html">About</a></td></tr></table></div>
<table border="0" cellpadding="0" cellspacing="0" class="navline" width="100%">
<tr><td class="navline"><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td class="navline">&nbsp;<a href="../../index.html">home</a> > <a href="../index.html">installation natlink/vocola/unimacro</a> > <a href="index.html">technical details</a> > natlinkstatus</td></tr></table></td></tr></table>

<!-- === end of header === --></div><div class="body" id="divbody"><table cellspacing="0" class="body" width="100%"><tr><td class="leftpart" id="leftpart" width="25%"><table cellspacing="0" class="leftpart" width="100%"><tr><td class="leftmenu" id="leftmenu"><!-- === left menu === -->
<table class="leftmenu" cellspacing="0" width="100%">
<tr><td class="leftoff" colspan="2"><a href="../installationstableversionpython2.html">Installation stable version python2</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../installationexperimentalversionpython3.html">Installation experimental version python3</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../configuration.html">Configuration</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../howtostart.html">How to start</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../logofchanges/index.html">Log of changes</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../problemswithinstallation.html">Problems with installation?</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../problemswithnatlink.html">Problems with NatLink?</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../speechmodel.html">Speech Model</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../inifilestrategy.html">Ini file strategy</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../configureadministratorrights.html">Configure administrator rights</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../settinghome/index.html">Setting HOME</a></td></tr>

<tr><td class="lefton" colspan="2"><a href="index.html">Technical details</a></td></tr>
    
<tr><td class="back" width="20">&nbsp;</td><td class="lefton">Natlinkstatus</td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="natlinkconfigfunctions.html">Natlinkconfigfunctions</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="natlinkcorefunctions.html">Natlinkcorefunctions</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="configuregui.html">configure GUI</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="batchmodeforconfiguration.html">Batch mode for configuration</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="installer.html">Installer</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="natlinkmainvocolamain.html">Natlinkmain_vocola_main</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="natlinkmain.html">Natlinkmain</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="natlinkutils.html">Natlinkutils</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="nsformat.html">Nsformat</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="testingnatlink.html">Testing natlink</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="workingwithsubversion/index.html">Working with subversion</a></td></tr>
</table>

<!-- == end of left menu == --></td></tr></table></td><td class="body0" id="body0" width="76%"><table cellspacing="0" class="body" width="100%"><tr><td class="body" id="body" valign="top"><h1>Natlinkstatus module</h1>
<p>This module holds "status" information about NatLink (new around 2008, version 3.7). It is in the core folder of NatLink.  Both <strong>natlinkmain</strong> and the NatLink install functions (<strong>natlinkconfigfunctions</strong>)can make use of the status info in the same way.</p>

<p>In a grammar a <strong>status</strong> instance can be got:</p>
<p class="pre">import natlinkstatus<br>
status = natlinkstatus.NatlinkStatus()</p>

<p>and the functions can be called accordingly with eg:</p>
<p class="pre">&nbsp;&nbsp;&nbsp;&nbsp;userDir = status.getUserDirectory()</p>

<p>So, most data are collected through this instance "status" of the NatlinkStatus class.</p>

<p>Up to version 3.8 most of these data were stored and retrieved in the registry, HKCU\software\NatLink (HKEY_CURRENT_USER).  Only the username and the folder of the speech profile of the current user is collected when the user changes, and is maintained in this class, as a class variable.</p>

<p>Starting with version 3.9 the user settings are stored in a configuration file (<strong>natlinkstatus.ini</strong>), which is created on first use in the <strong>Core</strong> directory. When migrating from a previous version, the registry settings are copied into this natlinkstatus.ini file.</p>

<p class="pre">The functions below are in class NatlinkStatus. The natlinkconfigfunctions<br>
can subclass this class.</p>

<h3>The following  functions manage information that partly can change at changeCallback time</h3>

<p>(when a new user opens)</p>
<p class="pre"><br>
setUserInfo(args) put username and directory of speech profiles of the last opened user in this class.<br>
getUserName: get active username (only if NatSpeak/NatLink is running)<br>
getDNSuserDirectory: get directory of user speech profile (only if NatSpeak/NatLink is running)</p>

<h3>The functions below should not change anything in settings, only  get information.</h3>

<p class="pre">getDNSInstallDir:<br>
&nbsp;&nbsp;&nbsp;&nbsp;returns the directory where NatSpeak is installed.<br>
&nbsp;&nbsp;&nbsp;&nbsp;if the registry key NatspeakInstallDir exists(CURRENT_USER/Software/NatLink),<br>
&nbsp;&nbsp;&nbsp;&nbsp;this path is taken (if it points to a valid folder)<br>
&nbsp;&nbsp;&nbsp;&nbsp;Otherwise one of the default paths is taken,<br>
&nbsp;&nbsp;&nbsp;&nbsp;%PROGRAMFILES%\Nuance\... or %PROGRAMFILES%\ScanSoft\...<br>
&nbsp;&nbsp;&nbsp;&nbsp;It must contain at least a Program subdirectory<br>
<br>
getDNSIniDir:<br>
&nbsp;&nbsp;&nbsp;&nbsp;returns the directory where the NatSpeak Inifiles are located,<br>
&nbsp;&nbsp;&nbsp;&nbsp;notably nssystem.ini and nsapps.ini.<br>
&nbsp;&nbsp;&nbsp;&nbsp;If the registry key NatspeakIniDir exists (CURRENT_USER/Software/NatLink),<br>
&nbsp;&nbsp;&nbsp;&nbsp;and the folder exists and the needed inifiles are in this folder this path is returned.<br>
&nbsp;&nbsp;&nbsp;&nbsp;Otherwise it is looked for in %COMMON_APPDATA%\Nuance\... or %COMMON_APPDATA%\Scansoft\...<br>
<br>
getDNSVersion:<br>
&nbsp;&nbsp;&nbsp;&nbsp;returns the in the version number of NatSpeak, as an integer. So 9, 8, 7, ... (???)<br>
&nbsp;&nbsp;&nbsp;&nbsp;note distinction is made here between different subversions.<br>
<br>
getWindowsVersion:<br>
&nbsp;&nbsp;&nbsp;&nbsp;see source below<br>
<br>
getLanguage:<br>
&nbsp;&nbsp;&nbsp;&nbsp;returns the 3 letter code of the language of the speech profile that<br>
&nbsp;&nbsp;&nbsp;&nbsp;is open (only possible when NatSpeak/NatLink is running)<br>
<br>
getPythonVersion:<br>
&nbsp;&nbsp;&nbsp;&nbsp;returns, as a string, the python version. Eg. &ldquo;2.3&rdquo;<br>
&nbsp;&nbsp;&nbsp;&nbsp;If it cannot find it in the registry it returns an empty string<br>
<br>
getUserDirectory: get the NatLink user directory, Unimacro will be there. If not return &rsquo;&rsquo;<br>
<br>
getVocolaUserDirectory: get the directory of Vocola User files, if not return &rsquo;&rsquo;<br>
<br>
NatlinkIsEnabled:<br>
&nbsp;&nbsp;&nbsp;&nbsp;return 1 or 0 whether NatLink is enabled or not<br>
&nbsp;&nbsp;&nbsp;&nbsp;returns None when strange values are found<br>
&nbsp;&nbsp;&nbsp;&nbsp;(checked with the Ini file settings of NSSystemIni and NSAppsIni)<br>
<br>
getNSSYSTEMIni(): get the path of nssystem.ini<br>
getNSAPPSIni(): get the path of nsapps.ini<br>
<br>
getBaseModelBaseTopic:<br>
&nbsp;&nbsp;&nbsp;&nbsp;return these as strings, not ready yet, only possible when<br>
&nbsp;&nbsp;&nbsp;&nbsp;NatSpeak/NatLink is running.<br>
<br>
getDebugLoad:<br>
&nbsp;&nbsp;&nbsp;&nbsp;get value from registry, if set do extra output of natlinkmain at (re)load time<br>
getDebugCallback:<br>
&nbsp;&nbsp;&nbsp;&nbsp;get value from registry, if set do extra output of natlinkmain at callbacks is given<br>
<br>
getVocolaTakesUnimacroActions<br>
getVocolaTakesLanguages: additional settings for Vocola<br>
<br>
more: see source...</p>

<p>When run the module in IDLE or Pythonwin on my desktop (Quintijn) I get:</p>

<p class="pre">UserDirectory: D:\natlink\unimacro<br>
inserted in sys.path: D:\natlink\unimacro<br>
---NatLink is enabled<br>
&nbsp;CoreDirectory	D:\natlink\natlink\MacroSystem\core<br>
&nbsp;InstallVersion	3.8<br>
---Vocola is enabled<br>
&nbsp;VocolaUserDirectory	D:\Documenten\vocolaqh<br>
&nbsp;VocolaTakesLanguages	1<br>
---Unimacro is enabled<br>
&nbsp;UserDirectory	D:\natlink\unimacro<br>
&nbsp;UnimacroUserDirectory	D:\Documenten\unimacroqh<br>
&nbsp;UnimacroIniFilesEditor	C:\Program Files\ActiveState Komodo IDE 5\komodo.exe<br>
other NatLink info:<br>
&nbsp;DebugLoad	-<br>
&nbsp;DebugCallback	-<br>
&nbsp;NatlinkDebug	-<br>
system information:<br>
&nbsp;DNSInstallDir	C:\Program Files\Nuance\NaturallySpeaking9<br>
&nbsp;DNSIniDir	C:\Documents and Settings\All Users\Application Data\Nuance\NaturallySpeaking9<br>
&nbsp;DNSVersion	9<br>
&nbsp;WindowsVersion	XP<br>
&nbsp;PythonVersion	2.5<br>
remaining information:<br>
&nbsp;DNSFullVersion	9.51.200.282<br>
&nbsp;NatlinkDllRegistered	1<br>
&nbsp;IncludeUnimacroInPythonPath	-</p>

<h3>Expanding Environment Variables</h3>
<p>This was described already in <a href="natlinkcorefunctions.html">natlinkcorefunctions</a>. But via natlinkstatus, this expansion mechanism can also use a few <strong>Natlink</strong> related variables. Note the variables are <strong>case sensitive</strong>.</p>

<p>Usage example:</p>
<p class="pre">import natlinkstatus<br>
<br>
short = &rdquo;~/Quintijn&rdquo;<br>
expanded = natlinkstatus.expandEnvVars(short)<br>
print &lsquo;Some directory in home:&rsquo;, expanded<br>
<br>
# the Dragon directory:<br>
short = &rdquo;%PROGRAMFILES%/Nuance&rdquo;<br>
expanded = natlinkstatus.expandEnvVars(short)<br>
print &ldquo;The dragon directory: %s&rdquo;% expanded<br>
# the Dragon ini files directory:<br>
short = &rdquo;%COMMON_APPDATA%/Nuance&rdquo;<br>
expanded = natlinkstatus.expandEnvVars(short)<br>
print &ldquo;The dragon config files: %s&rdquo;% expanded<br>
<br>
# log files in Unimacro:<br>
short = &rdquo;%UNIMACROUSERDIRECTORY%/enx_log&rdquo;<br>
expanded = natlinkstatus.expandEnvVars(short)<br>
print &ldquo;log files directory Unimacro: %s&rdquo;% expanded<br>
<br>
# My VocolaUserDirectory:<br>
short = &rdquo;%VOCOLAUSERDIRECTORY%&rdquo;<br>
expanded = natlinkstatusexpandEnvVars(short)<br>
print &ldquo;My VocolaUserDirectory: %s&rdquo;% expanded<br></p>

<p>prints for example:</p>
<p class="pre">Some directory in home: C:\Documenten\Quintijn<br>
The dragon directory: C:\Program Files (x86)\Nuance<br>
The dragon config files: C:\ProgramData\Nuance<br>
My UnimacroUserDirectory: C:\Documenten\unimacro_qh\enx_log<br>
My VocolaUserDirectory: C:\Documenten\vocola_qh</p>

<p>Read more about these extended environment variables in <a href="../../grammars/globalgrammars/folders/environmentvariables.html">grammar folders</a>.</p></td></tr></table></td></tr></table></div><div class="footer" id="footer"><!-- === start of footer === -->

<table border="0" cellpadding="0" cellspacing="0" class="bottomline" width="100%">
<tr><td class="navline"><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td class="navline">&nbsp;<a href="../../index.html">home</a> > <a href="../index.html">installation natlink/vocola/unimacro</a> > <a href="index.html">technical details</a> > natlinkstatus > <a href="javascript:scrollTo(0,0);">top</a></td></tr></table></td><td class="sitemapbutton" onclick="location='../../sitemap.html#natlinkstatus';" onmouseout="status='';" onmouseover="status='go to the sitemap';"><a href="../../sitemap.html#natlinkstatus">sitemap</a></td><td class="navline" width="5"></td><td class="emailbutton" onclick="" onmouseout="status='';" onmouseover="status='send e-mail';"><noscript class="underline">q.hoogenboom</noscript>
<script language="javascript" type="text/javascript"><!--
m("antenna.nl", "q.hoogenboom", "information about: natlinkstatus", "e-mail");

// --></script>
<noscript class="underline">at&nbsp;antenna.nl</noscript></td><td class="navline" width="5"></td><td class="copyright">&copy;&nbsp;<strong>unimacro</strong>,&nbsp;jul 2020</td><td class="copprintonly">&copy;&nbsp;<strong>unimacro</strong>,&nbsp;jul 2020<br> | a SourceForge Project by Quintijn Hoogenboom, Bart Jan van Os, Frank Olaf Sem-Jacobsen, Doug Ransom.</td></tr></table>

<!-- === end of footer === --></div>
<script language="javascript" type="text/javascript"><!--
function onResizeFunctions(){

bodyHeight(170);

}


function onLoadFunctions(){

onResizeFunctions();


return;
}


// --></script>

</body></html>