<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<title>technical details, natlinkconfigfunctions</title>
<meta charset="UTF-8">
<meta name="description" content="Natlink and Unimacro, for a Dragon NaturallySpeaking macro facility">
<meta name="keywords" content="Installation, Natlink/Vocola/Unimacro, Install, python, 27, technical, details, natlinkconfigfunctions, technical details, Install for python 27, Installation Natlink/Vocola/Unimacro">
<meta name="author" content="QH software, training & advies, 2002/2017 (informatie: info at sitegen.nl)">
<link rel="stylesheet" href="../../../unimacro.css" type="text/css" title="unimacro.css">
<!--[if lte IE 6]>
<link rel="stylesheet" href="../../../unimacroie6.css" type="text/css" title="unimacroie6.css">
<![endif]-->
<!--[if IE 7]>
<link rel="stylesheet" href="../../../unimacroie7.css" type="text/css" title="unimacroie7.css">
<![endif]-->
<!--[if IE 8]>
<link rel="stylesheet" href="../../../unimacroie8.css" type="text/css" title="unimacroie8.css">
<![endif]-->
<!--[if IE 9]>
<link rel="stylesheet" href="../../../unimacroie9.css" type="text/css" title="unimacroie9.css">
<![endif]-->
<script language="javascript" src="../../../unimacro.js" type="text/javascript"></script><link href="/unimacro/favicon.ico" rel="shortcut icon" type="image/x-icon"></head>
<body onload="afterLoad();" onresize="onResize();"><div class="header" id="header"><!-- === start of header === -->

<table border="0" cellpadding="0" cellspacing="0" class="body" width="100%">
<tr><td class="banner">Unimacro</td><td width="30%">&nbsp;</td></tr></table>

<table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td height="15"></td></tr></table>
<div class="topmenuwide"><table border="0" cellspacing="0" class="menu" width="100%"><tr><td align="center" class="topon" height="28" onclick="location='../../index.html';" onmouseout="status='';" onmouseover="status='Installation Natlink/Vocola/Unimacro';"><a href="../../index.html">Installation Natlink/Vocola/Unimacro</a></td><td class="topspacer" height="28" width="5">&nbsp;</td><td align="center" class="topoff" height="28" onclick="location='../../../features/index.html';" onmouseout="status='';" onmouseover="status='Features';"><a href="../../../features/index.html">Features</a></td><td class="topspacer" height="28" width="5">&nbsp;</td><td align="center" class="topoff" height="28" onclick="location='../../../grammars/index.html';" onmouseout="status='';" onmouseover="status='Grammars';"><a href="../../../grammars/index.html">Grammars</a></td><td class="topspacer" height="28" width="5">&nbsp;</td>
<td align="center" class="topoff" height="28" onclick="location='../../../aboutunimacro/index.html';" onmouseout="status='';" onmouseover="status='About';"><a href="../../../aboutunimacro/index.html">About</a></td></tr></table></div>
<table border="0" cellpadding="0" cellspacing="0" class="navline" width="100%">
<tr><td class="navline"><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td class="navline">&nbsp;<a href="../../../index.html">home</a> > <a href="../../index.html">installation natlink/vocola/unimacro</a> > <a href="../installationstableversionpython2.html">install for python 27</a> > <a href="index.html">technical details</a> > natlinkconfigfunctions</td></tr></table></td></tr></table>

<!-- === end of header === --></div><div class="body" id="divbody"><table cellspacing="0" class="body" width="100%"><tr><td class="leftpart" id="leftpart" width="25%"><table cellspacing="0" class="leftpart" width="100%"><tr><td class="leftmenu" id="leftmenu"><!-- === left menu === -->
<table class="leftmenu" cellspacing="0" width="100%">
<tr><td class="lefton" colspan="3"><a href="../installationstableversionpython2.html">Install for python 27</a></td></tr>
    
<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../installationstableversionpython2.html">Installation stable version python2</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../configuration.html">Configuration</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../howtostart.html">How to start</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../logofchanges/index.html">Log of changes</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../problemswithinstallation.html">Problems with installation</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../problemswithnatlink.html">problems with NatLink</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../speechmodel.html">Speech Model</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../inifilestrategy.html">Ini file strategy</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../configureadministratorrights.html">Configure administrator rights</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../settinghome/index.html">Setting HOME</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="lefton" colspan="2"><a href="index.html">Technical details</a></td></tr>
        
<tr><td class="back" width="20">&nbsp;</td><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="natlinkstatus.html">Natlinkstatus</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="back" width="20">&nbsp;</td><td class="lefton">Natlinkconfigfunctions</td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="natlinkcorefunctions.html">Natlinkcorefunctions</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="configuregui.html">configure GUI</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="batchmodeforconfiguration.html">Batch mode for configuration</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="installer.html">Installer</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="natlinkmainvocolamain.html">Natlinkmain_vocola_main</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="natlinkmain.html">Natlinkmain</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="natlinkutils.html">Natlinkutils</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="nsformat.html">Nsformat</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="testingnatlink.html">Testing natlink</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="workingwithsubversion/index.html">Working with subversion</a></td></tr>

<tr><td class="leftoff" colspan="3"><a href="../../installationexperimentalversionpython3.html">Installation experimental version python3</a></td></tr>

<tr><td class="leftoff" colspan="3"><a href="../../logofchangespython3.html">log of changes Python 3</a></td></tr>
</table>

<!-- == end of left menu == --></td></tr></table></td><td class="body0" id="body0" width="76%"><table cellspacing="0" class="body" width="100%"><tr><td class="body" id="body" valign="top"><h1>NatLink Configuration Functions</h1>
<p>This module <strong>natlinkconfigfunctions.py</strong> is in the same directory as the configure GUI.  It contains the necessary functions for the configuration procedure. If run direct, use</p>
<ul><li>IDLE (right click on the file, Edit with IDLE and press F5.  (at exit (q) some strange message may show up, just ignore)</li><li>python (right click on the file, Open with, python)</li><li>PythonWin (right click on the file, Edit with PythonWin; Press F5)</li></ul>

<p>When the CLI starts, and also the config GUI, some checks are performed as to the current installation:</p>
<ul><li>It must find the coreDirectory to be in the same directory tree as the calling module. If this fails, something strange is happening.</li><li>The path of the coreDirectory is compared with settings in registry of the PythonPath section. If something differs, you started the CLI or config GUI from another location as before. You are asked to either:</li>    <ul>    <li>(re)register NatLink.dll, and setting the correct paths in the registry. Quit the program and restart NatSpeak. Note you loose previous settings of eg VocolaUserDirectory.</li>    <li>quit this program and rerun from the location you used before for configuring NatLink.</li></ul>
</ul>

<h3>The current commands of the CLI are:</h3>
<p class="pre">i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- info, print information about the NatLink status<br>
I&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- settings, print information about the natlinkstatus.ini settings<br>
j&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- print PythonPath variable<br>
<br>
[NatLink]<br>
<br>
e/E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- enable/disable NatLink<br>
<br>
y/Y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- enable/disable debug callback output of natlinkmain<br>
x/X&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- enable/disable debug load output&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of natlinkmain<br>
<br>
d/D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- set/clear DNSInstallDir, the directory where NatSpeak/Dragon is installed<br>
c/C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- set/clear DNSINIDir, where NatSpeak/Dragon INI files are located<br>
<br>
[Vocola]<br>
<br>
v/V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- enable/disable Vocola by setting/clearing VocolaUserDirectory, the user<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory for Vocola Command Files (.vcl) (~ or %HOME% allowed, see below).<br>
<br>
b/B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- enable/disable distinction between languages for Vocola user files<br>
a/A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- enable/disable the possibility to use Unimacro actions in Vocola<br>
<br>
[Unimacro]<br>
<br>
o/O&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- enable/disable Unimacro, by setting/clearing the UnimacroUserDirectory, where<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the Unimacro User (Ini) Files are located, and several other directories (~ or %HOME% allowed, see below)<br>
f/F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- force Unimacro directory to be in the python path, even if<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unimacro is disabled (-F: do not force this)<br>
p/P&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- set/clear path for program that opens Unimacro User (Ini) Files (if cleared, notepad is used)<br>
l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- copy header file Unimacro.vch into Vocola User Directory<br>
m/M&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- insert/remove an include line for Unimacro.vch in all Vocola<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;command files<br>
<br>
[UserDirectory]<br>
n/N&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- enable/disable UserDirectory, the directory where<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;User NatLink grammar files are located (e.g., ...\Documents\NatLinkUserDirectory)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(see Note below on the change in October 2015)<br>
<br>
[Repair]<br>
r/R&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- register/unregister NatLink, the natlink.pyd (natlink.pyd) file<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(should not be needed)<br>
z/Z&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- silently enables NatLink and registers natlink.pyd / disables NatLink<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and unregisters natlink.pyd.<br>
[AutoHotkey]<br>
h/H&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- set/clear the AutoHotkey exe directory.<br>
k/K&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- set/clear the User Directory for AutoHotkey scripts.<br>
[Other]<br>
<br>
u/usage - give this list<br>
q&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- quit<br>
<br>
help &lt;command>: give more explanation on &lt;command></p>

<h3>Using ~ or %USERNAME%, %PROGRAMFILES% etc.</h3>
<p>Using these variables (<strong>~</strong> is equal to <strong>%HOME%</strong>), variable paths can be set for the various directories. This can only be done by using the CLI, or using the natlinkconfigfunctions in batch mode. <strong>This trick cannot be used in the config GUI</strong>. See the link(/installation/settinghome/index.html, Setting HOME Variable) page for more explanation.</p>

<h3>enable/disable NatLink</h3>
<p>The commands <strong>e</strong> to enable and <strong>E</strong> to disable should be enough.</p>

<h3>enable/disable Vocola</h3>
<p>Assume <strong>_vocola_main.py</strong> is in the baseDirectory of NatLink, eg C:\NatLink\NatLink\MacroSystem. You should not worry about this directory.</p>

<p>Vocola will be enabled when a valid VocolaUserDirectory is set with the <strong>v</strong> option.  The path can be something like ~\VocolaUser. Your Vocola Command Files will be located in this directory.</p>

<p>When this directory is cleared (<strong>V</strong>) Vocola is disabled and will not load when NatLink starts at Dragon startup.</p>

<h3>enable/disable Unimacro</h3>
<p>This is done by setting a UnimacroUserDirectory (option <strong>o</strong>), the path can be for example: ~/UnimacroUser). User Ini Files will be located in this directory. The grammar files of Unimacro are in the NatLink tree, eg C:\NatLink\Unimacro.</p>

<p>Disable by clearing this directory (option <strong>U</strong>).</p>
<h3>Special Vocola option: use different languages</h3>
<p>If enabled (<strong>b</strong>), Vocola will look and put its Command Files into a subdirectory "xxx" of
VocolaUserDirectory IF the language code of
the user speech profiles is different from "enx".</p>

<p>So for English users this option will have no effect, the  Command Files are in ~\VocolaUser, but...</p>
<ul><li>Dutch will go in <strong>~\VocolaUser\nld</strong>,</li><li>French in <strong>~\VocolaUser\fra</strong></li><li>German  in <strong>~\VocolaUser\deu</strong></li><li>Italian in <strong>~\VocolaUser\ita</strong></li><li>Spanish in <strong>~\VocolaUser\esp</strong></li></ul>

<p>But as soon as you switch off this option (<strong>B</strong>) Vocola will get and put all Command Files from/in the VocolaUserDirectory (in our example: ~\VocolaUser).</p>

<h3>Python versions</h3><ul><li>Natlink.pyd is still compiled for python 2.5, but only for Dragon up to version 11.5.</li><li>For both Dragon <= 11.5 and for Dragon 12 and above there are now natlink.pyd versions for python 2.6 and python 2.7.</li></ul>

<h3>Older versions of Dragon NaturallySpeaking</h3>
<p>Older versions of Dragon should be working with Python 2.5, 2.6 and 2.7.</p>

<p>If you have an older version of Dragon NaturallySpeaking, try to configure the</p>
<ul><li>DNSInstallDir (option <strong>d</strong>) and</li><li>DNSIniDir (option <strong>c</strong>).</li></ul>

<h3>PythonPath strategy</h3>
<p>How Dragon finds natlink:</p><ul><li>The coreDirectory is inserted in the python path by defining them in the registry(eg for python 2.7)  HKLM\SOFTWARE\Python\PythonCore\2.7\PythonPath\NatLink (HKLM stands for HKEY_LOCAL_MACHINE). This is the way Dragon can find natlink.pyd.</li><li>The BaseDirectory, UnimacroDirectory and the UserDirectory, whenever active, are set by natlinkmain.py into the PythonPath variable, when Dragon starts.</li></ul></td></tr></table></td></tr></table></div><div class="footer" id="footer"><!-- === start of footer === -->

<table border="0" cellpadding="0" cellspacing="0" class="bottomline" width="100%">
<tr><td class="navline"><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td class="navline">&nbsp;<a href="../../../index.html">home</a> > <a href="../../index.html">installation natlink/vocola/unimacro</a> > <a href="../installationstableversionpython2.html">install for python 27</a> > <a href="index.html">technical details</a> > natlinkconfigfunctions > <a href="javascript:scrollTo(0,0);">top</a></td></tr></table></td><td class="sitemapbutton" onclick="location='../../../sitemap.html#natlinkconfigfunctions';" onmouseout="status='';" onmouseover="status='go to the sitemap';"><a href="../../../sitemap.html#natlinkconfigfunctions">sitemap</a></td><td class="navline" width="5"></td><td class="emailbutton" onclick="" onmouseout="status='';" onmouseover="status='send e-mail';"><noscript class="underline">q.hoogenboom</noscript>
<script language="javascript" type="text/javascript"><!--
m("antenna.nl", "q.hoogenboom", "information about: natlinkconfigfunctions", "e-mail");

// --></script>
<noscript class="underline">at&nbsp;antenna.nl</noscript></td><td class="navline" width="5"></td><td class="copyright">&copy;&nbsp;<strong>unimacro</strong>,&nbsp;mrt 2021</td><td class="copprintonly">&copy;&nbsp;<strong>unimacro</strong>,&nbsp;mrt 2021<br> | a SourceForge Project by Quintijn Hoogenboom, Bart Jan van Os, Frank Olaf Sem-Jacobsen, Doug Ransom.</td></tr></table>

<!-- === end of footer === --></div>
<script language="javascript" type="text/javascript"><!--
function onResizeFunctions(){

bodyHeight(170);

}


function onLoadFunctions(){

onResizeFunctions();


return;
}


// --></script>

</body></html>