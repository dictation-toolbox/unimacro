<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<title>unimacro, features, Numbers and Spoken Forms</title>
<meta charset="UTF-8">
<meta name="description" content="Natlink and Unimacro, for a Dragon NaturallySpeaking macro facility">
<meta name="keywords" content="features, Numbers, Spoken, Forms, Numbers and Spoken Forms">
<meta name="author" content="QH software, training & advies, 2002/2017 (informatie: info at sitegen.nl)">
<link rel="stylesheet" href="../../unimacro.css" type="text/css" title="unimacro.css">
<!--[if lte IE 6]>
<link rel="stylesheet" href="../../unimacroie6.css" type="text/css" title="unimacroie6.css">
<![endif]-->
<!--[if IE 7]>
<link rel="stylesheet" href="../../unimacroie7.css" type="text/css" title="unimacroie7.css">
<![endif]-->
<!--[if IE 8]>
<link rel="stylesheet" href="../../unimacroie8.css" type="text/css" title="unimacroie8.css">
<![endif]-->
<!--[if IE 9]>
<link rel="stylesheet" href="../../unimacroie9.css" type="text/css" title="unimacroie9.css">
<![endif]-->
<script language="javascript" src="../../unimacro.js" type="text/javascript"></script><link href="/unimacro/favicon.ico" rel="shortcut icon" type="image/x-icon"></head>
<body onload="afterLoad();" onresize="onResize();"><div class="header" id="header"><!-- === start of header === -->

<table border="0" cellpadding="0" cellspacing="0" class="body" width="100%">
<tr><td class="banner">Unimacro</td><td width="30%">&nbsp;</td></tr></table>

<table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td height="15"></td></tr></table>
<div class="topmenuwide"><table border="0" cellspacing="0" class="menu" width="100%"><tr><td align="center" class="topoff" height="28" onclick="location='../../installation/index.html';" onmouseout="status='';" onmouseover="status='Installation Natlink/Vocola/Unimacro';"><a href="../../installation/index.html">Installation Natlink/Vocola/Unimacro</a></td><td class="topspacer" height="28" width="5">&nbsp;</td><td align="center" class="topon" height="28" onclick="location='../index.html';" onmouseout="status='';" onmouseover="status='Features';"><a href="../index.html">Features</a></td><td class="topspacer" height="28" width="5">&nbsp;</td><td align="center" class="topoff" height="28" onclick="location='../../grammars/index.html';" onmouseout="status='';" onmouseover="status='Grammars';"><a href="../../grammars/index.html">Grammars</a></td><td class="topspacer" height="28" width="5">&nbsp;</td>
<td align="center" class="topoff" height="28" onclick="location='../../aboutunimacro/index.html';" onmouseout="status='';" onmouseover="status='About';"><a href="../../aboutunimacro/index.html">About</a></td></tr></table></div>
<table border="0" cellpadding="0" cellspacing="0" class="navline" width="100%">
<tr><td class="navline"><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td class="navline">&nbsp;<a href="../../index.html">home</a> > <a href="../index.html">features</a> > numbers and spoken forms</td></tr></table></td></tr></table>

<!-- === end of header === --></div><div class="body" id="divbody"><table cellspacing="0" class="body" width="100%"><tr><td class="leftpart" id="leftpart" width="25%"><table cellspacing="0" class="leftpart" width="100%"><tr><td class="leftmenu" id="leftmenu"><!-- === left menu === -->
<table class="leftmenu" cellspacing="0" width="100%">
<tr><td class="leftoff" colspan="2"><a href="../actions/index.html">Actions</a></td></tr>

<tr><td class="lefton" colspan="2">Numbers and Spoken Forms</td></tr>    
<tr><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="otherspokenformsections.html">Other spokenform sections</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../unimacroandvocola/index.html">Unimacro and Vocola</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../tracing.html">Tracing</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../inifiles.html">Inifiles</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../translations/index.html">Translations</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../cooperationwithvoicecoder/index.html">Cooperation with voicecoder</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../autohotkey/index.html">AutoHotkey</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../unittesting/index.html">Unit testing</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../grammarclasses/index.html">Grammar classes</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../globaldictation/index.html">Global dictation</a></td></tr>

<tr><td class="leftoff" colspan="2"><a href="../monitorfunctions/index.html">Monitorfunctions</a></td></tr>
</table>

<!-- == end of left menu == --></td></tr></table></td><td class="body0" id="body0" width="76%"><table cellspacing="0" class="body" width="100%"><tr><td class="body" id="body" valign="top"><h1>Numbers and spoken forms</h1>
<p>With the module <strong>spokenforms.py</strong> grammar lists of numbers can be converted to a list of spoken forms. These lists are used in the grammars. The configuring of the spoken forms lists is done with <a href="../../features/inifiles.html"><strong>ini files</strong></a>, see this page for a description of the most important sections.</p>

<p>The central class in this module is the class <strong>SpokenForms</strong>, which is instantiated automatically in all IniGrammar and DocstringGrammar grammars. The instance variable is then <strong>self.spokenforms</strong>.</p>

<h3>Definition time</h3>
<p>When a grammar is initialized, lists of numbers, see below, are automatically converted into spoken forms.</p>

<p>This is done either</p><ul><li>automatically, functionality in <strong>natlinkutilsbj.py</strong>, see function <strong>fillGrammarLists</strong> or</li><li>in the <strong>initialize</strong> function of the grammar class. Call like:</li></ul>

<p class="pre">&nbsp;&nbsp;&nbsp;&nbsp;self.taskCounts = range(1, self.maxTaskNumber+1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;self.setNumbersList(&lsquo;taskcount&rsquo;, self.taskCounts)</p>

<p>where 'taskcount' is the name of the list in the grammar definition, and self.taskCounts the list of numbers that should be recognized.</p>
<ul><li>note: in this second case you need to define lists that are not caught automatically in the automatic procedure, like:</li></ul>

<p class="pre">&nbsp;&nbsp;&nbsp;&nbsp;iniIgnoreGrammarLists = [&lsquo;windowcount&rsquo;, &lsquo;iconcount&rsquo;, &lsquo;taskcount&rsquo;]</p>

<h3>Recognition time</h3>
<p>At recognition time the spoken forms can be converted back into numbers.</p>

<p class="pre">&nbsp;&nbsp;&nbsp;&nbsp;countBack = self.getNumberFromSpoken(countOrApp, self.taskCounts) # returns a string or None</p>
<ul><li>Here countOrApp is the word that was recognized, for example '3'.</li><li>The second parameter is optional. If you leave it away, among all known spoken forms will be searched.</li></ul>

<h1>Function and Class of the module spokenforms.py</h1>
<h3>Class</h3><ul><li>SpokenForms. As pointed out above this class is automatically called in all <strong>IniGrammar</strong> and <strong>DocstringGrammar</strong> grammars.</li></ul>

<h3>Functions</h3>
<h3>function getNumberList(specification)</h3>
<p>If the specification meets one of the global variables in the spokenforms module this list is returned, currently this is only:</p>

<table border="1" cellspacing="0" class="table"><tr><th class="TH1"><p>variable</p></th><th class="TH"><p>contents:</p></th></tr>

<tr><td class="TD1"><p>number1to99stripped</p></td><td class="TD"><p>&#091;1, 2, ..., 19 , 20, 30, 40, ..., 90&#93;</p></td></tr></table>

<p>&nbsp;</p>
<p><strong>Other specifications</strong> must start with <strong>n</strong> or <strong>number</strong> and separate two numbers by a <strong>-</strong> or by <strong>to</strong>.</p>

<p>Lists with larger values return only multiples of 10. Do not go beyond <strong>100</strong> with this trick (yet)</p>

<p>Examples:</p>
<table border="1" cellspacing="0" class="table"><tr><th class="TH1"><p>specification</p></th><th class="TH"><p>returns:</p></th></tr>

<tr><td class="TD1"><p>n1-9</p></td><td class="TD"><p>&#091;1, 2, 3, ..., 9&#93;</p></td></tr>

<tr><td class="TD1"><p>number1-99</p></td><td class="TD"><p>&#091;1, 2, 3, ..., 99&#93;</p></td></tr>

<tr><td class="TD1"><p>number10to90</p></td><td class="TD"><p>&#091;10, 20, 30, ..., 90&#093;</p></td></tr>

<tr><td class="TD1"><p>n0to90</p></td><td class="TD"><p>&#091;0, 1, 2, 3, ..., 90&#093;</p></td></tr></table>

<p>&nbsp;</p>
<h1>class SpokenForms:</h1>
<p>This class is tested as good as possible in <strong>unimacro_test/unittestSpokenForms.py</strong>. See there also for examples.</p>

<p>Each instances takes a language as variable, like <strong>enx</strong> for English and <strong>nld</strong> for Dutch, called <strong>xxx</strong> below.</p>

<p>A .ini file called <strong>xxx_spokenforms.ini</strong> is expected (if not present, taken from one of the possible sample directory's).</p>

<p>Internally at first call (first instance) the dictionary's <strong>n2s</strong> and <strong>s2n</strong> are filled. Hopefully all instances have the same language, otherwise the system goes dada.</p>

<h3>getMixedList(List)</h3>
<p>Input is a list of numbers (also strings representing number may be given)
Output is a list of the spoken forms. If the spoken form is not found in n2s (from numbers.ini) the string representation of the number is taken (also the case when an empty numbers.ini file is used).</p>

<h3>getNumberFromSpoken(word, originalList=None, asStr=None)</h3>
<p>In a recognition the words of the recognition can be converted back into the origating number ('two' into 2).</p>

<p>When you pass the <strong>originalList</strong>, the result is checked with this list as well. Not needed in most cases.</p>

<p>When you pass <strong>asStr=1</strong>, a string ('2') is returned, otherwise a int (like 2) is returned.</p>

<h3>getNumbersFromSpoken(words, originalList=None, asStr=None)</h3>
<p>If the <strong>words</strong> is a list, a list of number recognitions is returned.
Example: input is the recognition &#091;'example', 'one', 'and', 'thirteen'&#093;, then this function will return &#091;1, 13&#093;</p>

<h2>Use in a grammar nearly automatic (example IniGrammar grammar):</h2>

<p>(See also grammars _tasks.py, _lines.py)</p>
<h3>Definition</h3>
<p>Define the number lists as {n1-20} etc., example:</p>
<p class="pre">&lt;wordspec> = word | {n2-20} words;</p>
<h3>At recognition time</h3>
<p>In the callback function retrieve the number (or numbers) with above functions, which however can be called through wrappers in the IniGrammar class:</p>

<p class="pre">&nbsp;&nbsp;&nbsp;&nbsp;def gotResults_wordspec(self,words,fullResults):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &ldquo;wordspec, got: &rdquo;, words<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;countList = self.getNumbersFromSpoken(words)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if countList:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count = countList[0]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count = 1&nbsp;&nbsp;# no count words found in recognition<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &lsquo;count: %s&rsquo;% count</p>

<p>alternatively you can code:</p>
<p class="pre">&nbsp;&nbsp;&nbsp;&nbsp;def gotResults_wordspec(self,words,fullResults):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &ldquo;wordspec, got: &rdquo;, words<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count = self.getNumberFromSpoken(words[0]) or 1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &lsquo;count: %s&rsquo;% count</p>

<h2>Use in a grammar, more specific :</h2>
<p>(See also grammars _tasks.py, this example is coded as a DocstringGrammar rule)</p>

<p class="pre">&nbsp;&nbsp;&nbsp;&nbsp;def rule_taskswitch(self, words):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&rdquo;&rdquo;&rdquo;#commands for switching tasks:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(task)({taskcount}|{application}|Back)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&rdquo;&rdquo;&rdquo;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#switch to a task by number, application or Back<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count = words[1]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;countBack = self.getNumberFromSpoken(count, self.taskCounts) # returns a string or None<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if countBack:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass # a number is found<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass # proceed with count, which can be one of the applications defined else or &ldquo;Back&rdquo;</p>

<p>At the top of the grammar the following line is inserted, which means the definition and activation of the mentioned lists is done in the grammar module itself:</p>

<p class="pre">&nbsp;&nbsp;&nbsp;&nbsp;iniIgnoreGrammarLists = [&lsquo;windowcount&rsquo;, &lsquo;iconcount&rsquo;, &lsquo;taskcount&rsquo;]</p>

<p>In the initialize function you define the lists yourself (in the function setNumbersList the connection with the numbers module is established)</p>

<p class="pre">&nbsp;&nbsp;&nbsp;&nbsp;def initialize(self):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.load(self.gramSpec)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.switchOnOrOff()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.maxTaskNumber = 20<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.taskCounts = range(1, self.maxTaskNumber+1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.setNumbersList(&lsquo;taskcount&rsquo;, self.taskCounts)</p>

<h3>Large numbers</h3>
<p>These are handled in special grammar rules, see <a href="../../grammars/globalgrammars/number/index.html">_number.py</a></p></td></tr></table></td></tr></table></div><div class="footer" id="footer"><!-- === start of footer === -->

<table border="0" cellpadding="0" cellspacing="0" class="bottomline" width="100%">
<tr><td class="navline"><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td class="navline">&nbsp;<a href="../../index.html">home</a> > <a href="../index.html">features</a> > numbers and spoken forms > <a href="javascript:scrollTo(0,0);">top</a></td></tr></table></td><td class="sitemapbutton" onclick="location='../../sitemap.html#numbers';" onmouseout="status='';" onmouseover="status='go to the sitemap';"><a href="../../sitemap.html#numbers">sitemap</a></td><td class="navline" width="5"></td><td class="emailbutton" onclick="" onmouseout="status='';" onmouseover="status='send e-mail';"><noscript class="underline">q.hoogenboom</noscript>
<script language="javascript" type="text/javascript"><!--
m("antenna.nl", "q.hoogenboom", "information about: unimacro", "e-mail");

// --></script>
<noscript class="underline">at&nbsp;antenna.nl</noscript></td><td class="navline" width="5"></td><td class="copyright">&copy;&nbsp;<strong>unimacro</strong>,&nbsp;feb 2021</td><td class="copprintonly">&copy;&nbsp;<strong>unimacro</strong>,&nbsp;feb 2021<br> | a SourceForge Project by Quintijn Hoogenboom, Bart Jan van Os, Frank Olaf Sem-Jacobsen, Doug Ransom.</td></tr></table>

<!-- === end of footer === --></div>
<script language="javascript" type="text/javascript"><!--
function onResizeFunctions(){

bodyHeight(170);

}


function onLoadFunctions(){

onResizeFunctions();


return;
}


// --></script>

</body></html>