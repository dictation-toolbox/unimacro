<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<title>unimacro, grammars, global grammars, latex, Syntax highlighting Word</title>
<meta charset="UTF-8">
<meta name="description" content="Natlink and Unimacro, for a Dragon NaturallySpeaking macro facility">
<meta name="keywords" content="grammars, global, latex, Syntax, highlighting, Word, global grammars, Syntax highlighting Word">
<meta name="author" content="QH software, training & advies, 2002/2017 (informatie: info at sitegen.nl)">
<link rel="stylesheet" href="../../../unimacro.css" type="text/css" title="unimacro.css">
<!--[if lte IE 6]>
<link rel="stylesheet" href="../../../unimacroie6.css" type="text/css" title="unimacroie6.css">
<![endif]-->
<!--[if IE 7]>
<link rel="stylesheet" href="../../../unimacroie7.css" type="text/css" title="unimacroie7.css">
<![endif]-->
<!--[if IE 8]>
<link rel="stylesheet" href="../../../unimacroie8.css" type="text/css" title="unimacroie8.css">
<![endif]-->
<!--[if IE 9]>
<link rel="stylesheet" href="../../../unimacroie9.css" type="text/css" title="unimacroie9.css">
<![endif]-->
<script language="javascript" src="../../../unimacro.js" type="text/javascript"></script><link href="/unimacro/favicon.ico" rel="shortcut icon" type="image/x-icon"></head>
<body onload="afterLoad();" onresize="onResize();"><div class="header" id="header"><!-- === start of header === -->

<table border="0" cellpadding="0" cellspacing="0" class="body" width="100%">
<tr><td class="banner">Unimacro</td><td width="30%">&nbsp;</td></tr></table>

<table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td height="15"></td></tr></table>
<div class="topmenuwide"><table border="0" cellspacing="0" class="menu" width="100%"><tr><td align="center" class="topoff" height="28" onclick="location='../../../installation/index.html';" onmouseout="status='';" onmouseover="status='Installation Natlink/Vocola/Unimacro';"><a href="../../../installation/index.html">Installation Natlink/Vocola/Unimacro</a></td><td class="topspacer" height="28" width="5">&nbsp;</td><td align="center" class="topoff" height="28" onclick="location='../../../features/index.html';" onmouseout="status='';" onmouseover="status='Features';"><a href="../../../features/index.html">Features</a></td><td class="topspacer" height="28" width="5">&nbsp;</td><td align="center" class="topon" height="28" onclick="location='../../index.html';" onmouseout="status='';" onmouseover="status='Grammars';"><a href="../../index.html">Grammars</a></td><td class="topspacer" height="28" width="5">&nbsp;</td>
<td align="center" class="topoff" height="28" onclick="location='../../../aboutunimacro/index.html';" onmouseout="status='';" onmouseover="status='About';"><a href="../../../aboutunimacro/index.html">About</a></td></tr></table></div>
<table border="0" cellpadding="0" cellspacing="0" class="navline" width="100%">
<tr><td class="navline"><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td class="navline">&nbsp;<a href="../../../index.html">home</a> > <a href="../../index.html">grammars</a> > <a href="../folders/index.html">global grammars</a> > <a href="index.html">latex</a> > syntax highlighting word</td></tr></table></td></tr></table>

<!-- === end of header === --></div><div class="body" id="divbody"><table cellspacing="0" class="body" width="100%"><tr><td class="leftpart" id="leftpart" width="25%"><table cellspacing="0" class="leftpart" width="100%"><tr><td class="leftmenu" id="leftmenu"><!-- === left menu === -->
<table class="leftmenu" cellspacing="0" width="100%">
<tr><td class="leftoff" colspan="3"><a href="../../control/index.html">Control</a></td></tr>

<tr><td class="lefton" colspan="3"><a href="../folders/index.html">Global grammars</a></td></tr>
    
<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../folders/index.html">Folders</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../general/index.html">General</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../lines/index.html">Lines</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../tasks/index.html">Tasks</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../keystrokes/index.html">Keystrokes</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../repeat/index.html">Repeat</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../edit/index.html">Edit</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="lefton" colspan="2"><a href="index.html">Latex</a></td></tr>
        
<tr><td class="back" width="20">&nbsp;</td><td class="back" width="20">&nbsp;</td><td class="leftoff"><a href="configuration.html">Configuration</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="back" width="20">&nbsp;</td><td class="lefton">Syntax highlighting Word</td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../number/index.html">Number grammar</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../oops/index.html">Oops</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../shownumbersplus/index.html">Show numbers plus</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../tags/index.html">Tags</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../brackets/index.html">Brackets</a></td></tr>

<tr><td class="back" width="20">&nbsp;</td><td class="leftoff" colspan="2"><a href="../modes/index.html">Modes</a></td></tr>

<tr><td class="leftoff" colspan="3"><a href="../../specificgrammars/index.html">Specific grammars</a></td></tr>

<tr><td class="leftoff" colspan="3"><a href="../../unimacrotest/index.html">Unimacro test</a></td></tr>

<tr><td class="leftoff" colspan="3"><a href="../../games/patience.html">Games</a></td></tr>
</table>

<!-- == end of left menu == --></td></tr></table></td><td class="body0" id="body0" width="76%"><table cellspacing="0" class="body" width="100%"><tr><td class="body" id="body" valign="top"><h1>How to configure Word for latex highlighting</h1>
<p>For completeness, below is the necessary Visual Basic functions for rudimentary latex highlighting in Microsoft Word. By adding these three functions to the Word macro system, all files with the extension .tex will be automatically highlighted everytime they are opened (In Word 2010 click "review"-> "macros"->"create". Bind the AutoOpen function to a keyboard shortcut to reformat the documents during editing (file->options->customise ribbon, keyboard shortcuts: customise...). This came to great effect be combined with the "edit all latex" and "edit ready" commands from the <a href="../../../grammars/globalgrammars/edit/index.html"><strong>_edit</strong> grammar</a>.</p>

<p class="pre">Sub AssociateStyle(pattern As String, style As String, colour As Long)<br>
&lsquo;Associate Styles with headings and quotations<br>
&lsquo;Ensure Tools/References/Microsoft VBscript Regular Expression 5.5 is on<br>
<br>
Dim regEx, Match<br>
&lsquo;Dim Matches As MatchCollection<br>
Dim str As String<br>
Dim region As Range<br>
<br>
Set regEx = CreateObject(&ldquo;VBScript.RegExp&rdquo;)<br>
regEx.pattern = pattern&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&rsquo; Set pattern.<br>
regEx.Global = True<br>
regEx.MultiLine = True<br>
<br>
&lsquo;obtain matched RegExp.<br>
Set Matches = regEx.Execute(ActiveDocument.Range.Text)<br>
&lsquo;MsgBox (Len(ActiveDocument.Range.Text))<br>
&lsquo;MsgBox (Matches.Count)<br>
&lsquo;loop through and replace style<br>
For Each Match In Matches<br>
&nbsp;&nbsp;&nbsp;&nbsp;Set region = ActiveDocument.Range(Match.FirstIndex, Match.FirstIndex + Len(Match.Value))<br>
&nbsp;&nbsp;&nbsp;&nbsp;If colour > -1 Then<br>
&nbsp;&nbsp;&nbsp;&rsquo;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox (Match.Value)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&rsquo;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox (Match.FirstIndex)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&rsquo;&nbsp;&nbsp;&nbsp;MsgBox (Len(Match.Value))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;region.Font.ColorIndex = colour<br>
&nbsp;&nbsp;&nbsp;&nbsp;Else<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;region.style = _<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ActiveDocument.Styles(style)<br>
&nbsp;&nbsp;&nbsp;&nbsp;End If<br>
Next<br>
<br>
End Sub<br>
<br>
Sub ReplaceMarkup(pattern As String, markup As String)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;Selection.Find.ClearFormatting<br>
&nbsp;&nbsp;&nbsp;&nbsp;Selection.Find.Replacement.ClearFormatting<br>
&nbsp;&nbsp;&nbsp;&nbsp;With Selection.Find<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Text = pattern<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Replacement.Text = markup<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Forward = True<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Wrap = wdFindNo<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.Format = False<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.MatchCase = False<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.MatchWholeWord = False<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.MatchAllWordForms = False<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.MatchSoundsLike = False<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.MatchWildcards = True<br>
&nbsp;&nbsp;&nbsp;&nbsp;End With<br>
&nbsp;&nbsp;&nbsp;&nbsp;Selection.Find.Execute Replace:=wdReplaceAll<br>
End Sub<br>
<br>
<br>
Sub AutoOpen()<br>
&rsquo;<br>
&rsquo; AutoOpen Macro<br>
&rsquo; Macro recorded 5/6/2009 by reagle<br>
&rsquo;<br>
FileName = ActiveDocument.FullName<br>
Extension = Right(FileName, 3)<br>
If Extension = &ldquo;tex&rdquo; Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Selection.WholeStory<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Selection.Font.Name = &ldquo;Georgia&rdquo;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Selection.Font.Size = 12<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Selection.ParagraphFormat.LineSpacing = 16<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Selection.style = &ldquo;Body Text&rdquo;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lsquo;Call ReplaceMarkup(&rdquo;\\emph\{(*)\}&rdquo;, &rdquo;&lt;&lt;\1>>&rdquo;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call AssociateStyle(&rdquo;[{}]&rdquo;, &ldquo;Quote&rdquo;, wdGreen)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call AssociateStyle(&rdquo;\\.*?}&rdquo;, &ldquo;Quote&rdquo;, wdDarkBlue)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call AssociateStyle(&rdquo;^\\title{&rdquo;, &ldquo;Heading 1&rdquo;, -1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call AssociateStyle(&rdquo;^\\chapter{&rdquo;, &ldquo;Heading 1&rdquo;, -1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call AssociateStyle(&rdquo;^\\section{&rdquo;, &ldquo;Heading 1&rdquo;, -1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call AssociateStyle(&rdquo;^\\subsection{&rdquo;, &ldquo;Heading 2&rdquo;, -1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call AssociateStyle(&rdquo;^\\subsubsection{&rdquo;, &ldquo;Heading 3&rdquo;, -1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call AssociateStyle(&rdquo;^\\begin{quotation}&rdquo;, &ldquo;Quote&rdquo;, -1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call AssociateStyle(&rdquo;\$.*?\$&rdquo;, &ldquo;Quote&rdquo;, wdRed)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Call AssociateStyle(&rdquo;[^\\]%.*?$&rdquo;, &ldquo;Quote&rdquo;, wdGray25)<br>
<br>
End If<br>
<br>
End Sub</p></td></tr></table></td></tr></table></div><div class="footer" id="footer"><!-- === start of footer === -->

<table border="0" cellpadding="0" cellspacing="0" class="bottomline" width="100%">
<tr><td class="navline"><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td class="navline">&nbsp;<a href="../../../index.html">home</a> > <a href="../../index.html">grammars</a> > <a href="../folders/index.html">global grammars</a> > <a href="index.html">latex</a> > syntax highlighting word > <a href="javascript:scrollTo(0,0);">top</a></td></tr></table></td><td class="sitemapbutton" onclick="location='../../../sitemap.html#highlightinginmicrosoftword';" onmouseout="status='';" onmouseover="status='go to the sitemap';"><a href="../../../sitemap.html#highlightinginmicrosoftword">sitemap</a></td><td class="navline" width="5"></td><td class="emailbutton" onclick="" onmouseout="status='';" onmouseover="status='send e-mail';"><noscript class="underline">q.hoogenboom</noscript>
<script language="javascript" type="text/javascript"><!--
m("antenna.nl", "q.hoogenboom", "information about: Syntax highlighting Word", "e-mail");

// --></script>
<noscript class="underline">at&nbsp;antenna.nl</noscript></td><td class="navline" width="5"></td><td class="copyright">&copy;&nbsp;<strong>unimacro</strong>,&nbsp;mrt 2021</td><td class="copprintonly">&copy;&nbsp;<strong>unimacro</strong>,&nbsp;mrt 2021<br> | a SourceForge Project by Quintijn Hoogenboom, Bart Jan van Os, Frank Olaf Sem-Jacobsen, Doug Ransom.</td></tr></table>

<!-- === end of footer === --></div>
<script language="javascript" type="text/javascript"><!--
function onResizeFunctions(){

bodyHeight(170);

}


function onLoadFunctions(){

onResizeFunctions();


return;
}


// --></script>

</body></html>